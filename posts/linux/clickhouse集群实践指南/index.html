<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Clickhouseé›†ç¾¤å®è·µæŒ‡å— - ä¸€ä¸ªæ›¾ç»çš„å°ç å†œ...</title><meta name="author" content="0x5c0f">
<meta name="description" content="ClickHouse é›†ç¾¤å®è·µæŒ‡å—ï¼Œä»ç¬¬ä¸€æ¬¡åˆå§‹åŒ–ï¼Œåˆ°å¯æ‰©å±•ã€é«˜å¯ç”¨ã€å¯è¿ç»´"><meta name="keywords" content='linux, è§£å†³æ–¹æ¡ˆ'>
  <meta itemprop="name" content="clickhouseé›†ç¾¤å®è·µæŒ‡å—">
  <meta itemprop="description" content="ClickHouse é›†ç¾¤å®è·µæŒ‡å—ï¼Œä»ç¬¬ä¸€æ¬¡åˆå§‹åŒ–ï¼Œåˆ°å¯æ‰©å±•ã€é«˜å¯ç”¨ã€å¯è¿ç»´">
  <meta itemprop="datePublished" content="2025-12-17T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-12-17T00:00:00+00:00">
  <meta itemprop="wordCount" content="1431">
  <meta itemprop="image" content="https://blog.0x5c0f.cc/icons/logo_transparent.webp">
  <meta itemprop="keywords" content="Linux,è§£å†³æ–¹æ¡ˆ"><meta property="og:url" content="https://blog.0x5c0f.cc/posts/linux/clickhouse%E9%9B%86%E7%BE%A4%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97/">
  <meta property="og:site_name" content="ä¸€ä¸ªæ›¾ç»çš„å°ç å†œ...">
  <meta property="og:title" content="clickhouseé›†ç¾¤å®è·µæŒ‡å—">
  <meta property="og:description" content="ClickHouse é›†ç¾¤å®è·µæŒ‡å—ï¼Œä»ç¬¬ä¸€æ¬¡åˆå§‹åŒ–ï¼Œåˆ°å¯æ‰©å±•ã€é«˜å¯ç”¨ã€å¯è¿ç»´">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-17T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-17T00:00:00+00:00">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="è§£å†³æ–¹æ¡ˆ">
    <meta property="og:image" content="https://blog.0x5c0f.cc/icons/logo_transparent.webp">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://blog.0x5c0f.cc/icons/logo_transparent.webp">
  <meta name="twitter:title" content="clickhouseé›†ç¾¤å®è·µæŒ‡å—">
  <meta name="twitter:description" content="ClickHouse é›†ç¾¤å®è·µæŒ‡å—ï¼Œä»ç¬¬ä¸€æ¬¡åˆå§‹åŒ–ï¼Œåˆ°å¯æ‰©å±•ã€é«˜å¯ç”¨ã€å¯è¿ç»´">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="https://blog.0x5c0f.cc/posts/linux/clickhouse%E9%9B%86%E7%BE%A4%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97/" title="clickhouseé›†ç¾¤å®è·µæŒ‡å— - ä¸€ä¸ªæ›¾ç»çš„å°ç å†œ..." /><link rel="prev" type="text/html" href="https://blog.0x5c0f.cc/posts/hugo/ai%E5%88%9B%E4%BD%9C%E5%86%85%E5%AE%B9%E5%A3%B0%E6%98%8E%E7%BB%84%E4%BB%B6/" title="AIåˆ›ä½œå†…å®¹å£°æ˜ç»„ä»¶" /><link rel="next" type="text/html" href="https://blog.0x5c0f.cc/posts/linux/%E9%82%A3%E4%BA%9B%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB%E7%9A%84%E8%AE%B0%E5%BD%95.3/" title="é‚£äº›æ‚ä¸ƒæ‚å…«çš„è®°å½•(ä¸‰)" /><link rel="alternate" type="text/markdown" href="https://blog.0x5c0f.cc/posts/linux/clickhouse%E9%9B%86%E7%BE%A4%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97/index.md" title="clickhouseé›†ç¾¤å®è·µæŒ‡å— - ä¸€ä¸ªæ›¾ç»çš„å°ç å†œ..."><link rel="stylesheet" href="/css/config.min.055ba22ec07e226fb0524aa7c1cad7c835a0439ba7eb18280122246ab3ef74d2b8929a575dd59a6c6c27d7d0bee23a499d09df9c23e0542d66c33c4f4fd77599.css" integrity="sha512-BVuiLsB+Im+wUkqnwcrXyDWgQ5un6xgoASIkarPvdNK4kppXXdWabGwn19C+4jpJnQnfnCPgVC1mwzxPT9d1mQ=="><link rel="stylesheet" href="/css/style.min.5516b21935ab930257ccd9906a509eece4fa3eae45fa80681bce0a64aa038d939c84f607bcd216b86fa9f9bd881abb2931053d975b038cbd1a813ed1d842df29.css" integrity="sha512-VRayGTWrkwJXzNmQalCe7OT6Pq5F+oBoG84KZKoDjZOchPYHvNIWuG+p+b2IGrspMQU9l1sDjL0agT7R2ELfKQ=="><link rel="preload" href="/lib/fontawesome-free/all.min.e47b37745d8010f92934047b5223876dafa545224d78cd840a4c31508c42d50fc52f27064db35aa565c1e2d3fcf3d9394f926ef1fb386f53f9cff881e2731f49.css" integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ==" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.e47b37745d8010f92934047b5223876dafa545224d78cd840a4c31508c42d50fc52f27064db35aa565c1e2d3fcf3d9394f926ef1fb386f53f9cff881e2731f49.css" integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ=="></noscript><link rel="preload" href="/lib/animate/animate.min.738daa4d2c3fc0f677ff92c1cc3f81c397fb6d2176a31a2eeb011bf88fe5a9e68a57914321f32fbd1a7bef6cb88dc24b2ae1943a96c931d83f053979d1f25803.css" integrity="sha512-c42qTSw/wPZ3/5LBzD+Bw5f7bSF2oxou6wEb+I/lqeaKV5FDIfMvvRp772y4jcJLKuGUOpbJMdg/BTl50fJYAw==" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.738daa4d2c3fc0f677ff92c1cc3f81c397fb6d2176a31a2eeb011bf88fe5a9e68a57914321f32fbd1a7bef6cb88dc24b2ae1943a96c931d83f053979d1f25803.css" integrity="sha512-c42qTSw/wPZ3/5LBzD+Bw5f7bSF2oxou6wEb+I/lqeaKV5FDIfMvvRp772y4jcJLKuGUOpbJMdg/BTl50fJYAw=="></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "clickhouseé›†ç¾¤å®è·µæŒ‡å—",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/blog.0x5c0f.cc\/posts\/linux\/clickhouse%E9%9B%86%E7%BE%A4%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97\/"
    },"genre": "posts","keywords": "linux, è§£å†³æ–¹æ¡ˆ","wordcount":  1431 ,
    "url": "https:\/\/blog.0x5c0f.cc\/posts\/linux\/clickhouse%E9%9B%86%E7%BE%A4%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97\/","datePublished": "2025-12-17T00:00:00+00:00","dateModified": "2025-12-17T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "0x5c0f"
      },"description": "ClickHouse é›†ç¾¤å®è·µæŒ‡å—ï¼Œä»ç¬¬ä¸€æ¬¡åˆå§‹åŒ–ï¼Œåˆ°å¯æ‰©å±•ã€é«˜å¯ç”¨ã€å¯è¿ç»´"
  }
  </script><script src="/js/head/color-scheme.min.868a4788a670ce019ec1bcfda2ce1a524a209616ec174d2b1e8a110b2c4dabdb7b3ae71eee18de8b1161ff0c42b5bab134a7dc6cb49a662ee677d3f5a172e59a.js" integrity="sha512-hopHiKZwzgGewbz9os4aUkoglhbsF00rHooRCyxNq9t7Ouce7hjeixFh/wxCtbqxNKfcbLSaZi7md9P1oXLlmg=="></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="ä¸€ä¸ªæ›¾ç»çš„å°ç å†œ..."><span class="typeit"><template>0x5c0f.cc</template></span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/">æ‰€æœ‰æ–‡ç« </a></li><li class="menu-item">
              <a class="menu-link" href="/tags/">æ ‡ç­¾</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/">åˆ†ç±»</a></li><li class="menu-item">
              <a class="menu-link" href="/archives/">å½’æ¡£</a></li><li class="menu-item">
              <a class="menu-link" href="/about/">About</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹â€¦â€¦" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li><li class="menu-item language-switch auto d-none" aria-hidden="true">
    <span role="button" aria-label="é€‰æ‹©è¯­è¨€" title="é€‰æ‹©è¯­è¨€"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
    <ul class="sub-menu"><li class="menu-item active" data-type="artificial">
          <a href="/posts/linux/clickhouse%E9%9B%86%E7%BE%A4%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97/" data-lang="zh-CN" class="menu-link text-secondary" title="ç®€ä½“ä¸­æ–‡">
            <i class="fa-solid fa-person fa-fw fa-sm" aria-hidden="true"></i> ç®€ä½“ä¸­æ–‡</a>
        </li><li class="menu-item-divider" aria-hidden="true"></li><li class="menu-item" data-type="machine">
          <a data-lang="english" class="menu-link" title="English">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> English</a>
        </li><li class="menu-item" data-type="machine">
          <a data-lang="chinese_simplified" class="menu-link" title="ç®€ä½“ä¸­æ–‡">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> ç®€ä½“ä¸­æ–‡</a>
        </li><li class="menu-item" data-type="machine">
          <a data-lang="japanese" class="menu-link" title="æ—¥æœ¬èª">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> æ—¥æœ¬èª</a>
        </li><li class="menu-item" data-type="machine">
          <a data-lang="chinese_traditional" class="menu-link" title="ç¹é«”ä¸­æ–‡">
            <i class="fa-solid fa-robot fa-fw fa-sm" aria-hidden="true"></i> ç¹é«”ä¸­æ–‡</a>
        </li></ul>
  </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="ä¸€ä¸ªæ›¾ç»çš„å°ç å†œ..."><span class="typeit"><template>0x5c0f.cc</template></span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹â€¦â€¦" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              å–æ¶ˆ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/posts/">æ‰€æœ‰æ–‡ç« </a></li><li class="menu-item"><a class="menu-link" href="/tags/">æ ‡ç­¾</a></li><li class="menu-item"><a class="menu-link" href="/categories/">åˆ†ç±»</a></li><li class="menu-item"><a class="menu-link" href="/archives/">å½’æ¡£</a></li><li class="menu-item"><a class="menu-link" href="/about/">About</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span><span id="translate" class="menu-system-item language-switch auto d-none" aria-hidden="true">
    <span role="button" aria-label="é€‰æ‹©è¯­è¨€" title="é€‰æ‹©è¯­è¨€" data-current="ç®€ä½“ä¸­æ–‡">ç®€ä½“ä¸­æ–‡<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
  </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="åˆé›†"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>Clickhouseé›†ç¾¤å®è·µæŒ‡å—</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="https://blog.0x5c0f.cc" title="ä½œè€…"target="_blank" rel="external nofollow noopener noreferrer author" class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
    0x5c0f</a></span><span class="post-included-in">&nbsp;æ”¶å½•äº <a href="/categories/linux/" class="post-category" title="åˆ†ç±» - Linux"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Linux</a>&ensp;<a href="/categories/%E8%BF%90%E7%BB%B4%E8%AE%B0%E4%BA%8B/" class="post-category" title="åˆ†ç±» - è¿ç»´è®°äº‹"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> è¿ç»´è®°äº‹</a> å’Œ <a href="/collections/%E8%BF%90%E7%BB%B4%E8%AE%B0%E4%BA%8B/" class="post-collection" title="åˆé›† - è¿ç»´è®°äº‹"><i class="fa-solid fa-layer-group fa-fw" aria-hidden="true"></i> è¿ç»´è®°äº‹</a></span></div><div class="post-meta-line"><span title="å‘å¸ƒäº 2025-12-17 00:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-12-17">2025-12-17</time></span>&nbsp;<span title="1431 å­—"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>çº¦ 1500 å­—</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>é¢„è®¡é˜…è¯» 7 åˆ†é’Ÿ</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>ç›®å½•</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1-å†™åœ¨å‰é¢è¿™ç¯‡æ–‡ç« é€‚åˆè°">1. å†™åœ¨å‰é¢ï¼šè¿™ç¯‡æ–‡ç« é€‚åˆè°ï¼Ÿ</a></li>
    <li><a href="#2-å®˜æ–¹å®‰è£…æŒ‡å—">2. å®˜æ–¹å®‰è£…æŒ‡å—</a></li>
    <li><a href="#3-clickhouse-é›†ç¾¤çš„æ•´ä½“è®¤çŸ¥">3. ClickHouse é›†ç¾¤çš„æ•´ä½“è®¤çŸ¥</a></li>
    <li><a href="#4-ä¸ºä»€ä¹ˆå•èŠ‚ç‚¹ä¹Ÿè¦ç”¨é›†ç¾¤æ¨¡å¼åˆå§‹åŒ–">4. ä¸ºä»€ä¹ˆâ€œå•èŠ‚ç‚¹ä¹Ÿè¦ç”¨é›†ç¾¤æ¨¡å¼åˆå§‹åŒ–â€</a>
      <ul>
        <li><a href="#41-å¸¸è§è¯¯åŒº">4.1. å¸¸è§è¯¯åŒº</a></li>
        <li><a href="#42-æ­£ç¡®åšæ³•æ¨è">4.2. æ­£ç¡®åšæ³•ï¼ˆæ¨èï¼‰</a></li>
      </ul>
    </li>
    <li><a href="#5-é›†ç¾¤é…ç½®clusterxml">5. é›†ç¾¤é…ç½®ï¼šcluster.xml</a>
      <ul>
        <li><a href="#51-æ–‡ä»¶ä½ç½®çº¦å®š">5.1. æ–‡ä»¶ä½ç½®ï¼ˆçº¦å®šï¼‰</a></li>
        <li><a href="#52-ç¤ºä¾‹å•èŠ‚ç‚¹èµ·æ­¥">5.2. ç¤ºä¾‹ï¼ˆå•èŠ‚ç‚¹èµ·æ­¥ï¼‰</a></li>
      </ul>
    </li>
    <li><a href="#6-keeperä¸ºä»€ä¹ˆå¿…é¡»æœ‰---æ€ä¹ˆé…-">6. Keeperï¼šä¸ºä»€ä¹ˆå¿…é¡»æœ‰ ï¼Ÿ &amp; æ€ä¹ˆé… ï¼Ÿ</a>
      <ul>
        <li><a href="#61-keeper-æ˜¯å¹²ä»€ä¹ˆçš„">6.1. Keeper æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ</a></li>
        <li><a href="#62-keeperxmlæœ€å°å¯ç”¨å•èŠ‚ç‚¹">6.2. keeper.xmlï¼ˆæœ€å°å¯ç”¨ï¼Œå•èŠ‚ç‚¹ï¼‰</a></li>
      </ul>
    </li>
    <li><a href="#7-å¤šç£ç›˜--å†·çƒ­åˆ†å±‚åˆå§‹åŒ–å°±è¯¥åš">7. å¤šç£ç›˜ / å†·çƒ­åˆ†å±‚ï¼ˆåˆå§‹åŒ–å°±è¯¥åšï¼‰</a>
      <ul>
        <li><a href="#71-ä¸ºä»€ä¹ˆè¦ä¸€å¼€å§‹å°±é…ç½®">7.1. ä¸ºä»€ä¹ˆè¦ä¸€å¼€å§‹å°±é…ç½®ï¼Ÿ</a></li>
        <li><a href="#72-storagexml">7.2. storage.xml</a></li>
      </ul>
    </li>
    <li><a href="#8-æ ‡å‡†å»ºè¡¨æ¨¡æ¿å†·çƒ­åˆ†å±‚--å¯æ‰©å±•">8. æ ‡å‡†å»ºè¡¨æ¨¡æ¿ï¼ˆå†·çƒ­åˆ†å±‚ + å¯æ‰©å±•ï¼‰</a>
      <ul>
        <li><a href="#81-å•å‰¯æœ¬å…¥é—¨--é-ha">8.1. å•å‰¯æœ¬ï¼ˆå…¥é—¨ / é HAï¼‰</a></li>
        <li><a href="#82-é«˜å¯ç”¨ç‰ˆæœ¬æ¨èç”Ÿäº§">8.2. é«˜å¯ç”¨ç‰ˆæœ¬ï¼ˆæ¨èï¼Œç”Ÿäº§ï¼‰</a></li>
      </ul>
    </li>
    <li><a href="#9-distributed-è¡¨ç»Ÿä¸€è¯»å†™å…¥å£">9. Distributed è¡¨ï¼ˆç»Ÿä¸€è¯»å†™å…¥å£ï¼‰</a></li>
    <li><a href="#10-å¤‡ä»½ä¸æ¢å¤">10. å¤‡ä»½ä¸æ¢å¤</a>
      <ul>
        <li><a href="#101-æ¨èå·¥å…·clickhouse-backup">10.1. æ¨èå·¥å…·ï¼šclickhouse-backup</a></li>
        <li><a href="#102-åˆ›å»ºå¤‡ä»½">10.2. åˆ›å»ºå¤‡ä»½</a></li>
        <li><a href="#103-æ¢å¤ç¤ºä¾‹å•è¡¨">10.3. æ¢å¤ç¤ºä¾‹ï¼ˆå•è¡¨ï¼‰</a></li>
        <li><a href="#104-æ¢å¤æ•´ä¸ªæ•°æ®åº“">10.4. æ¢å¤æ•´ä¸ªæ•°æ®åº“</a></li>
        <li><a href="#105-å…¶ä»–">10.5. å…¶ä»–</a></li>
      </ul>
    </li>
    <li><a href="#11-å‡çº§å’Œè¿ç§»">11. å‡çº§å’Œè¿ç§»</a>
      <ul>
        <li><a href="#111-æ­£ç¡®å§¿åŠ¿æ»šåŠ¨å‡çº§">11.1. æ­£ç¡®å§¿åŠ¿ï¼šæ»šåŠ¨å‡çº§</a></li>
        <li><a href="#112-å‡çº§å‰å¿…åš">11.2. å‡çº§å‰å¿…åšï¼š</a></li>
        <li><a href="#113-è¿ç§»æ¢æœºå™¨--æ‰©å®¹">11.3. è¿ç§»ï¼ˆæ¢æœºå™¨ / æ‰©å®¹ï¼‰</a></li>
      </ul>
    </li>
    <li><a href="#12-é«˜å¯ç”¨">12. é«˜å¯ç”¨</a>
      <ul>
        <li><a href="#121-è‡ªåŠ¨é‡è¯•-9000-ç«¯å£">12.1. è‡ªåŠ¨é‡è¯• 9000 ç«¯å£</a></li>
        <li><a href="#122-haproxy">12.2. HAProxy</a></li>
        <li><a href="#123-ä¸æ¨è-nginxé™¤é-http">12.3. ä¸æ¨è Nginxï¼ˆé™¤é HTTPï¼‰</a></li>
      </ul>
    </li>
    <li><a href="#13-æ‰©å®¹ä¸è‡ªåŠ¨å¤åˆ¶æ˜¯å¦‚ä½•å‘ç”Ÿçš„">13. æ‰©å®¹ä¸è‡ªåŠ¨å¤åˆ¶æ˜¯å¦‚ä½•å‘ç”Ÿçš„ï¼Ÿ</a></li>
    <li><a href="#14-æ€»ç»“ä¸€å¥—ä¸ä¼šåæ‚”çš„-clickhouse-æ¨¡æ¿">14. æ€»ç»“ï¼šä¸€å¥—â€œä¸ä¼šåæ‚”â€çš„ ClickHouse æ¨¡æ¿</a></li>
    <li><a href="#15-å…¶ä»–">15. å…¶ä»–</a></li>
  </ul>
</nav></div>
      </div><div class="ai-declaration" data-expanded="false">
  <div class="ai-declaration-header" onclick="this.parentElement.dataset.expanded = this.parentElement.dataset.expanded === 'false' ? 'true' : 'false'">
    <svg class="ai-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <span class="ai-declaration-text">ä½œè€…å£°æ˜ï¼šå†…å®¹ç”±AIè¾…åŠ©åˆ›ä½œ</span>
    <svg class="arrow-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </div>
  
  <div class="ai-declaration-content"><div class="ai-detail-item">
      <svg class="detail-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
        <path d="M12 16V12M12 8H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <span class="ai-value"><p>æœ¬æ–‡ä½¿ç”¨ <strong>ChatGpt</strong> è¾…åŠ©å®Œæˆï¼š</p>
<ul>
<li>æ–‡ç« ç»“æ„è§„åˆ’</li>
<li>é…ç½®åŠç¤ºä¾‹ç”Ÿæˆ</li>
<li>æŠ€æœ¯ç»†èŠ‚è§£é‡Šä¼˜åŒ–</li>
</ul>
<p>æ‰€æœ‰é…ç½®å‡ç»è¿‡å®é™…æµ‹è¯•éªŒè¯ã€‚</p>
</span>
    </div></div>
</div><div class="content" id="content"><div class="details admonition info open">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-circle-info" aria-hidden="true"></i>ä¿¡æ¯<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
  <div class="details-content">
    <div class="admonition-content"><p>å½“å‰æµ‹è¯•ç¯å¢ƒ:</p>
<ul>
<li><code>Ubuntu 24.04</code></li>
<li><code>ClickHouse server version 25.11.2.24 (official build)</code></li>
</ul></div>
  </div>
</div>
<h2 class="heading-element" id="1-å†™åœ¨å‰é¢è¿™ç¯‡æ–‡ç« é€‚åˆè°"><span>1. å†™åœ¨å‰é¢ï¼šè¿™ç¯‡æ–‡ç« é€‚åˆè°ï¼Ÿ</span>
  <a href="#1-%e5%86%99%e5%9c%a8%e5%89%8d%e9%9d%a2%e8%bf%99%e7%af%87%e6%96%87%e7%ab%a0%e9%80%82%e5%90%88%e8%b0%81" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>âœ” ç¬¬ä¸€æ¬¡æ¥è§¦ ClickHouse é›†ç¾¤</li>
<li>âœ” æƒ³ä»ä¸€å¼€å§‹å°±ç”¨â€œæ­£ç¡®å§¿åŠ¿â€</li>
<li>âœ” ä¸æƒ³ä»¥åå› ä¸ºæ—©æœŸå†³ç­–è¿”å·¥</li>
<li>âœ” éœ€è¦ä¸€ä»½ <strong>å¯é•¿æœŸå¤ç”¨çš„æ¨¡æ¿</strong></li>
</ul>
<p><strong>ä¸é€‚åˆ</strong>ï¼š</p>
<ul>
<li>åªæƒ³ä¸´æ—¶è·‘ä¸ª demo</li>
<li>ä¸å…³å¿ƒæ‰©å®¹ / é«˜å¯ç”¨ / è¿ç»´</li>
</ul>
<hr>
<h2 class="heading-element" id="2-å®˜æ–¹å®‰è£…æŒ‡å—"><span>2. å®˜æ–¹å®‰è£…æŒ‡å—</span>
  <a href="#2-%e5%ae%98%e6%96%b9%e5%ae%89%e8%a3%85%e6%8c%87%e5%8d%97" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><blockquote>
<p><a href="https://clickhouse.com/docs/zh/install"target="_blank" rel="external nofollow noopener noreferrer">https://clickhouse.com/docs/zh/install<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
</blockquote>
<h2 class="heading-element" id="3-clickhouse-é›†ç¾¤çš„æ•´ä½“è®¤çŸ¥"><span>3. ClickHouse é›†ç¾¤çš„æ•´ä½“è®¤çŸ¥</span>
  <a href="#3-clickhouse-%e9%9b%86%e7%be%a4%e7%9a%84%e6%95%b4%e4%bd%93%e8%ae%a4%e7%9f%a5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>åœ¨ <code>ClickHouse</code> ä¸­ï¼Œ<code>â€œé›†ç¾¤â€</code>ä¸æ˜¯ä¸€ä¸ªå¼€å…³ï¼Œè€Œæ˜¯<strong>ä¸€æ•´å¥—èƒ½åŠ›çš„ç»„åˆ</strong>ï¼š</p>
<div class="diagram-container">
  <pre class="mermaid">graph TD
    %% å®¢æˆ·ç«¯å±‚
    C[å®¢æˆ·ç«¯ / App] -->|è´Ÿè½½å‡è¡¡/é‡è¯•| D[Distributed è¡¨]

    %% åˆ†å¸ƒå¼è¡¨åˆ°æ•°æ®èŠ‚ç‚¹çš„è·¯ç”±
    subgraph DataNodes [ClickHouse æ•°æ®èŠ‚ç‚¹é›†ç¾¤]
        D --> S1[Shard 1:  MergeTree/Replicas]
        D --> S2[Shard 2:  MergeTree/Replicas]
    end

    %% åè°ƒå±‚å…³ç³»
    subgraph ControlPlane [åè°ƒä¸å…ƒæ•°æ®]
        K[ClickHouse Keeper / ZooKeeper]
    end

    %% èŠ‚ç‚¹ä¸ Keeper çš„å¿ƒè·³å’ŒåŒæ­¥
    S1 <--> K
    S2 <--> K

    %% æ ·å¼ç¾åŒ–
    style C fill:#f9f,stroke:#333
    style D fill:#bbf,stroke:#333
    style K fill:#fff4dd,stroke:#d4a017</pre>
  <pre class="mermaid-dark">graph TD
    %% å®¢æˆ·ç«¯å±‚
    C[å®¢æˆ·ç«¯ / App] -->|è´Ÿè½½å‡è¡¡/é‡è¯•| D[Distributed è¡¨]

    %% åˆ†å¸ƒå¼è¡¨åˆ°æ•°æ®èŠ‚ç‚¹çš„è·¯ç”±
    subgraph DataNodes [ClickHouse æ•°æ®èŠ‚ç‚¹é›†ç¾¤]
        D --> S1[Shard 1:  MergeTree/Replicas]
        D --> S2[Shard 2:  MergeTree/Replicas]
    end

    %% åè°ƒå±‚å…³ç³»
    subgraph ControlPlane [åè°ƒä¸å…ƒæ•°æ®]
        K[ClickHouse Keeper / ZooKeeper]
    end

    %% èŠ‚ç‚¹ä¸ Keeper çš„å¿ƒè·³å’ŒåŒæ­¥
    S1 <--> K
    S2 <--> K

    %% æ ·å¼ç¾åŒ–
    style C fill:#f9f,stroke:#333
    style D fill:#bbf,stroke:#333
    style K fill:#fff4dd,stroke:#d4a017</pre>
  <pre class="mermaid-neutral">graph TD
    %% å®¢æˆ·ç«¯å±‚
    C[å®¢æˆ·ç«¯ / App] -->|è´Ÿè½½å‡è¡¡/é‡è¯•| D[Distributed è¡¨]

    %% åˆ†å¸ƒå¼è¡¨åˆ°æ•°æ®èŠ‚ç‚¹çš„è·¯ç”±
    subgraph DataNodes [ClickHouse æ•°æ®èŠ‚ç‚¹é›†ç¾¤]
        D --> S1[Shard 1:  MergeTree/Replicas]
        D --> S2[Shard 2:  MergeTree/Replicas]
    end

    %% åè°ƒå±‚å…³ç³»
    subgraph ControlPlane [åè°ƒä¸å…ƒæ•°æ®]
        K[ClickHouse Keeper / ZooKeeper]
    end

    %% èŠ‚ç‚¹ä¸ Keeper çš„å¿ƒè·³å’ŒåŒæ­¥
    S1 <--> K
    S2 <--> K

    %% æ ·å¼ç¾åŒ–
    style C fill:#f9f,stroke:#333
    style D fill:#bbf,stroke:#333
    style K fill:#fff4dd,stroke:#d4a017</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i><i class="fa-solid fa-check text-success" aria-hidden="true"></i></div>
<template><pre>graph TD
    %% å®¢æˆ·ç«¯å±‚
    C[å®¢æˆ·ç«¯ / App] -->|è´Ÿè½½å‡è¡¡/é‡è¯•| D[Distributed è¡¨]

    %% åˆ†å¸ƒå¼è¡¨åˆ°æ•°æ®èŠ‚ç‚¹çš„è·¯ç”±
    subgraph DataNodes [ClickHouse æ•°æ®èŠ‚ç‚¹é›†ç¾¤]
        D --> S1[Shard 1:  MergeTree/Replicas]
        D --> S2[Shard 2:  MergeTree/Replicas]
    end

    %% åè°ƒå±‚å…³ç³»
    subgraph ControlPlane [åè°ƒä¸å…ƒæ•°æ®]
        K[ClickHouse Keeper / ZooKeeper]
    end

    %% èŠ‚ç‚¹ä¸ Keeper çš„å¿ƒè·³å’ŒåŒæ­¥
    S1 <--> K
    S2 <--> K

    %% æ ·å¼ç¾åŒ–
    style C fill:#f9f,stroke:#333
    style D fill:#bbf,stroke:#333
    style K fill:#fff4dd,stroke:#d4a017</pre></template>
</div><p><strong>è®°ä½ä¸€å¥è¯</strong>ï¼š</p>
<blockquote>
<p><code>ClickHouse</code> çš„é«˜å¯ç”¨ = <code>æ•°æ®å¯å¤åˆ¶</code> + <code>å…ƒæ•°æ®ä¸ä¸¢</code> + <code>è®¿é—®ä¸ä¸­æ–­</code></p>
</blockquote>
<hr>
<h2 class="heading-element" id="4-ä¸ºä»€ä¹ˆå•èŠ‚ç‚¹ä¹Ÿè¦ç”¨é›†ç¾¤æ¨¡å¼åˆå§‹åŒ–"><span>4. ä¸ºä»€ä¹ˆâ€œå•èŠ‚ç‚¹ä¹Ÿè¦ç”¨é›†ç¾¤æ¨¡å¼åˆå§‹åŒ–â€</span>
  <a href="#4-%e4%b8%ba%e4%bb%80%e4%b9%88%e5%8d%95%e8%8a%82%e7%82%b9%e4%b9%9f%e8%a6%81%e7%94%a8%e9%9b%86%e7%be%a4%e6%a8%a1%e5%bc%8f%e5%88%9d%e5%a7%8b%e5%8c%96" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="41-å¸¸è§è¯¯åŒº"><span>4.1. å¸¸è§è¯¯åŒº</span>
  <a href="#41-%e5%b8%b8%e8%a7%81%e8%af%af%e5%8c%ba" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><blockquote>
<p>â€œç°åœ¨åªæœ‰ä¸€å°æœºå™¨ï¼Œç”¨å•æœºæ¨¡å¼æ›´ç®€å•å§ï¼Ÿâ€</p>
</blockquote>
<p><em><strong>è¿™æ˜¯ ClickHouse ä¸­æœ€å®¹æ˜“ç•™ä¸‹æŠ€æœ¯å€ºçš„å†³å®šã€‚</strong></em></p>
<hr>
<h3 class="heading-element" id="42-æ­£ç¡®åšæ³•æ¨è"><span>4.2. æ­£ç¡®åšæ³•ï¼ˆæ¨èï¼‰</span>
  <a href="#42-%e6%ad%a3%e7%a1%ae%e5%81%9a%e6%b3%95%e6%8e%a8%e8%8d%90" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å³ä½¿åªæœ‰ <strong>1 å°æœºå™¨</strong>ï¼Œä¹Ÿè¦ï¼š</p>
<ul>
<li>é…ç½® <code>cluster.xml</code></li>
<li>é…ç½® <code>keeper.xml</code></li>
<li>æ‰€æœ‰ DDL ä½¿ç”¨ <code>ON CLUSTER</code></li>
</ul>
<p>åŸå› ï¼š</p>
<table>
  <thead>
      <tr>
          <th>å¥½å¤„</th>
          <th>è§£é‡Š</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>è¡¨ç»“æ„ä¸è¿”å·¥</td>
          <td>ä»¥ååŠ èŠ‚ç‚¹ä¸ç”¨é‡å»º</td>
      </tr>
      <tr>
          <td>ç”¨æ³•ç»Ÿä¸€</td>
          <td>å•æœº / é›†ç¾¤ SQL ä¸€æ ·</td>
      </tr>
      <tr>
          <td>ç¬¦åˆ 25.x è®¾è®¡</td>
          <td>ON CLUSTER å¼ºä¾èµ– Keeper</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 class="heading-element" id="5-é›†ç¾¤é…ç½®clusterxml"><span>5. é›†ç¾¤é…ç½®ï¼šcluster.xml</span>
  <a href="#5-%e9%9b%86%e7%be%a4%e9%85%8d%e7%bd%aeclusterxml" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="51-æ–‡ä»¶ä½ç½®çº¦å®š"><span>5.1. æ–‡ä»¶ä½ç½®ï¼ˆçº¦å®šï¼‰</span>
  <a href="#51-%e6%96%87%e4%bb%b6%e4%bd%8d%e7%bd%ae%e7%ba%a6%e5%ae%9a" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/etc/clickhouse-server/config.d/cluster.xml</span></span></code></pre></td></tr></table>
</div>
</div><h3 class="heading-element" id="52-ç¤ºä¾‹å•èŠ‚ç‚¹èµ·æ­¥"><span>5.2. ç¤ºä¾‹ï¼ˆå•èŠ‚ç‚¹èµ·æ­¥ï¼‰</span>
  <a href="#52-%e7%a4%ba%e4%be%8b%e5%8d%95%e8%8a%82%e7%82%b9%e8%b5%b7%e6%ad%a5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>
<p>å…³é”®è¯´æ˜</p>
<ul>
<li><strong>cluster åå­—éå¸¸é‡è¦</strong> åç»­æ‰€æœ‰ <code>ON CLUSTER xxx</code> éƒ½ä¾èµ–å®ƒ</li>
<li>shard â‰  replica
<ul>
<li>shardï¼šæ•°æ®æ°´å¹³åˆ‡åˆ†</li>
<li>replicaï¼šåŒä¸€æ•°æ®çš„å‰¯æœ¬</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;clickhouse&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;remote_servers&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- é›†ç¾¤åç§°ï¼Œåç»­ SQL ä¼šç”¨åˆ° --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;default_cluster&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- shardï¼šæ•°æ®åˆ†ç‰‡
</span></span></span><span class="line"><span class="cl"><span class="c">                    shard æ•°é‡ = æ•°æ®æ°´å¹³åˆ‡åˆ†çš„æ•°é‡
</span></span></span><span class="line"><span class="cl"><span class="c">                    ä¸€ä¸ª shard å¯ä»¥åŒ…å«å¤šä¸ª replicaï¼ˆå‰¯æœ¬èŠ‚ç‚¹ï¼‰ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;shard&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="c">&lt;!-- replicaï¼šå‰¯æœ¬ --&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;replica&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="c">&lt;!-- æœ¬æœºæœ€å¥½ä¹Ÿè®¾ç½®æ˜¯å†…ç½‘IP --&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;host&gt;</span>127.0.0.1<span class="nt">&lt;/host&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;port&gt;</span>9000<span class="nt">&lt;/port&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/replica&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/shard&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/default_cluster&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/remote_servers&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/clickhouse&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h2 class="heading-element" id="6-keeperä¸ºä»€ä¹ˆå¿…é¡»æœ‰---æ€ä¹ˆé…-"><span>6. Keeperï¼šä¸ºä»€ä¹ˆå¿…é¡»æœ‰ ï¼Ÿ &amp; æ€ä¹ˆé… ï¼Ÿ</span>
  <a href="#6-keeper%e4%b8%ba%e4%bb%80%e4%b9%88%e5%bf%85%e9%a1%bb%e6%9c%89---%e6%80%8e%e4%b9%88%e9%85%8d-" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="61-keeper-æ˜¯å¹²ä»€ä¹ˆçš„"><span>6.1. Keeper æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ</span>
  <a href="#61-keeper-%e6%98%af%e5%b9%b2%e4%bb%80%e4%b9%88%e7%9a%84" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><code>Keeper</code> è´Ÿè´£ï¼š</p>
<ul>
<li>åˆ†å¸ƒå¼ DDLï¼ˆ<code>ON CLUSTER</code>ï¼‰</li>
<li>å‰¯æœ¬å…ƒæ•°æ®</li>
<li>è¡¨é”</li>
<li>å‰¯æœ¬çŠ¶æ€åè°ƒ</li>
</ul>
<p><strong>æ²¡æœ‰ Keeperï¼Œé›†ç¾¤ä¼šâ€œçœ‹èµ·æ¥å­˜åœ¨ï¼Œä½†ä¸èƒ½ç”¨â€</strong></p>
<hr>
<h3 class="heading-element" id="62-keeperxmlæœ€å°å¯ç”¨å•èŠ‚ç‚¹"><span>6.2. keeper.xmlï¼ˆæœ€å°å¯ç”¨ï¼Œå•èŠ‚ç‚¹ï¼‰</span>
  <a href="#62-keeperxml%e6%9c%80%e5%b0%8f%e5%8f%af%e7%94%a8%e5%8d%95%e8%8a%82%e7%82%b9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>
<p><code>/etc/clickhouse-server/config.d/keeper.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;clickhouse&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- Keeper æœåŠ¡æœ¬èº« --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;keeper_server&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- Keeper å¯¹å¤–ç«¯å£ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;tcp_port&gt;</span>9181<span class="nt">&lt;/tcp_port&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- æ¯å°æœºå™¨å”¯ä¸€ï¼Œä¸èƒ½é‡å¤ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;server_id&gt;</span>1<span class="nt">&lt;/server_id&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- Keeper è‡ªå·±çš„æ•°æ®ç›®å½• --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;log_storage_path&gt;</span>
</span></span><span class="line"><span class="cl">            /var/lib/clickhouse/coordination/log
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/log_storage_path&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;snapshot_storage_path&gt;</span>
</span></span><span class="line"><span class="cl">            /var/lib/clickhouse/coordination/snapshots
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/snapshot_storage_path&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- Raft æˆå‘˜ï¼ˆå•èŠ‚ç‚¹ä¹Ÿè¦å†™ï¼‰ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;raft_configuration&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- å¤šå°‘ä¸ªèŠ‚ç‚¹(æˆå‘˜),å¤šå°‘ä¸ª server , å…¶ä¸­idä¸å¯¹åº”çš„ server_id ä¿æŒä¸€è‡´ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;server&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;id&gt;</span>1<span class="nt">&lt;/id&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;hostname&gt;</span>127.0.0.1<span class="nt">&lt;/hostname&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="c">&lt;!-- 9234 æ˜¯ Keeper èŠ‚ç‚¹ä¹‹é—´ Raft é€šä¿¡ç«¯å£ --&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;port&gt;</span>9234<span class="nt">&lt;/port&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/server&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/raft_configuration&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/keeper_server&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- ClickHouse Server é€šè¿‡è¿™é‡Œè®¿é—® Keeper --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;zookeeper&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- åŒæ ·å¤šå°‘ä¸ªèŠ‚ç‚¹,å¤šå°‘ä¸ªnode --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;node&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;host&gt;</span>127.0.0.1<span class="nt">&lt;/host&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- 9181 æ˜¯ ClickHouse Server è¿æ¥ Keeper çš„ç«¯å£ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;port&gt;</span>9181<span class="nt">&lt;/port&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/node&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/zookeeper&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/clickhouse&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>ğŸ“Œ <strong>æ˜“é”™ç‚¹</strong></p>
<ul>
<li><code>server_id</code> <strong>æ¯å°å¿…é¡»ä¸åŒ</strong></li>
<li>Keeper çš„ç›®å½• <strong>ä¸è¦å’Œæ•°æ®ç›®å½•æ··åœ¨ä¸€èµ·</strong></li>
<li>å³ä½¿å•èŠ‚ç‚¹ï¼Œä¹Ÿå¿…é¡»å†™ <code>raft_configuration</code></li>
</ul>
<hr>
<h2 class="heading-element" id="7-å¤šç£ç›˜--å†·çƒ­åˆ†å±‚åˆå§‹åŒ–å°±è¯¥åš"><span>7. å¤šç£ç›˜ / å†·çƒ­åˆ†å±‚ï¼ˆåˆå§‹åŒ–å°±è¯¥åšï¼‰</span>
  <a href="#7-%e5%a4%9a%e7%a3%81%e7%9b%98--%e5%86%b7%e7%83%ad%e5%88%86%e5%b1%82%e5%88%9d%e5%a7%8b%e5%8c%96%e5%b0%b1%e8%af%a5%e5%81%9a" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="71-ä¸ºä»€ä¹ˆè¦ä¸€å¼€å§‹å°±é…ç½®"><span>7.1. ä¸ºä»€ä¹ˆè¦ä¸€å¼€å§‹å°±é…ç½®ï¼Ÿ</span>
  <a href="#71-%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e4%b8%80%e5%bc%80%e5%a7%8b%e5%b0%b1%e9%85%8d%e7%bd%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>å†·çƒ­åˆ†å±‚æ˜¯ <strong>è¡¨çº§èƒ½åŠ›</strong></li>
<li>è¡¨ä¸€æ—¦å»ºå¥½ï¼Œåé¢å†è¡¥ç­–ç•¥ä¼šå¾ˆç—›è‹¦</li>
<li>Disk åœ¨ ClickHouse ä¸­åªæ˜¯<strong>ç›®å½•æŠ½è±¡</strong></li>
</ul>
<p>ğŸ‘‰ æ‰€ä»¥ï¼š<strong>å¯ä»¥å…ˆâ€œå‡è£…æœ‰å¤šå—ç›˜â€</strong></p>
<hr>
<h3 class="heading-element" id="72-storagexml"><span>7.2. storage.xml</span>
  <a href="#72-storagexml" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>/etc/clickhouse-server/config.d/storage.xml</code>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;clickhouse&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- ClickHouse æ•°æ®æ ¹ç›®å½• --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- æ‰€æœ‰è¡¨ã€å…ƒæ•°æ®éƒ½åœ¨è¿™é‡Œ --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;path&gt;</span>/data/clickhouse/<span class="nt">&lt;/path&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- å¤šç£ç›˜é…ç½® --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;storage_configuration&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- å®šä¹‰ç£ç›˜ï¼ˆé€»è¾‘ï¼‰ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;disks&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- çƒ­æ•°æ®ç›˜ï¼ˆæ¨¡æ‹Ÿ SSDï¼‰ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;hot&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;type&gt;</span>local<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;path&gt;</span>/data/clickhouse/hot/<span class="nt">&lt;/path&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/hot&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- å†·æ•°æ®ç›˜ï¼ˆæ¨¡æ‹Ÿ HDDï¼‰ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;cold&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;type&gt;</span>local<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;path&gt;</span>/data/clickhouse/cold/<span class="nt">&lt;/path&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/cold&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/disks&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- å­˜å‚¨ç­–ç•¥ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;policies&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- å†·çƒ­åˆ†å±‚ç­–ç•¥åç§° --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;hot_to_cold&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;volumes&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="c">&lt;!-- æ–°æ•°æ®ä¼˜å…ˆå†™è¿™é‡Œ --&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;hot_volume&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&lt;disk&gt;</span>hot<span class="nt">&lt;/disk&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;/hot_volume&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="c">&lt;!-- å†·æ•°æ®ç§»åŠ¨åˆ°è¿™é‡Œ --&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;cold_volume&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&lt;disk&gt;</span>cold<span class="nt">&lt;/disk&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;/cold_volume&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/volumes&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="c">&lt;!-- hot ä½¿ç”¨ç‡ &gt; 80% æ—¶å…è®¸ move --&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;move_factor&gt;</span>0.2<span class="nt">&lt;/move_factor&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/hot_to_cold&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/policies&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/storage_configuration&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/clickhouse&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>ğŸ“Œ <strong>æ³¨æ„</strong></p>
<ul>
<li>æ‰€æœ‰èŠ‚ç‚¹çš„ disk / policy åç§°å¿…é¡»ä¸€è‡´</li>
<li>åç»­æ¢çœŸå® SSD / HDD åªæ”¹ <code>path</code></li>
</ul>
<h2 class="heading-element" id="8-æ ‡å‡†å»ºè¡¨æ¨¡æ¿å†·çƒ­åˆ†å±‚--å¯æ‰©å±•"><span>8. æ ‡å‡†å»ºè¡¨æ¨¡æ¿ï¼ˆå†·çƒ­åˆ†å±‚ + å¯æ‰©å±•ï¼‰</span>
  <a href="#8-%e6%a0%87%e5%87%86%e5%bb%ba%e8%a1%a8%e6%a8%a1%e6%9d%bf%e5%86%b7%e7%83%ad%e5%88%86%e5%b1%82--%e5%8f%af%e6%89%a9%e5%b1%95" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="81-å•å‰¯æœ¬å…¥é—¨--é-ha"><span>8.1. å•å‰¯æœ¬ï¼ˆå…¥é—¨ / é HAï¼‰</span>
  <a href="#81-%e5%8d%95%e5%89%af%e6%9c%ac%e5%85%a5%e9%97%a8--%e9%9d%9e-ha" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">analytics</span><span class="p">.</span><span class="n">events</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="k">CLUSTER</span><span class="w"> </span><span class="n">default_cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">event_time</span><span class="w"> </span><span class="n">DateTime</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">user_id</span><span class="w"> </span><span class="n">UInt64</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">event_type</span><span class="w"> </span><span class="n">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">payload</span><span class="w"> </span><span class="n">String</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ENGINE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MergeTree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">toYYYYMM</span><span class="p">(</span><span class="n">event_time</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">(</span><span class="n">event_time</span><span class="p">,</span><span class="w"> </span><span class="n">user_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">TTL</span><span class="w"> </span><span class="n">event_time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="k">DAY</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">DISK</span><span class="w"> </span><span class="s1">&#39;cold&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">SETTINGS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">storage_policy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hot_to_cold&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 class="heading-element" id="82-é«˜å¯ç”¨ç‰ˆæœ¬æ¨èç”Ÿäº§"><span>8.2. é«˜å¯ç”¨ç‰ˆæœ¬ï¼ˆæ¨èï¼Œç”Ÿäº§ï¼‰</span>
  <a href="#82-%e9%ab%98%e5%8f%af%e7%94%a8%e7%89%88%e6%9c%ac%e6%8e%a8%e8%8d%90%e7%94%9f%e4%ba%a7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">analytics</span><span class="p">.</span><span class="n">events</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="k">CLUSTER</span><span class="w"> </span><span class="n">default_cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">event_time</span><span class="w"> </span><span class="n">DateTime</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">user_id</span><span class="w"> </span><span class="n">UInt64</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">event_type</span><span class="w"> </span><span class="n">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">payload</span><span class="w"> </span><span class="n">String</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ENGINE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReplicatedMergeTree</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">-- å¿…é¡»è¦æœ‰ macros.xml é…ç½®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">-- {shard} / {replica} æ˜¯ ClickHouse å†…ç½®å®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">-- åœ¨ ON CLUSTER æ‰§è¡Œæ—¶ç”±ç³»ç»Ÿè‡ªåŠ¨æ›¿æ¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">-- ä¸è¦æ‰‹å†™æˆå›ºå®šå€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="s1">&#39;/clickhouse/tables/{shard}/events&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s1">&#39;{replica}&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">toYYYYMM</span><span class="p">(</span><span class="n">event_time</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">(</span><span class="n">event_time</span><span class="p">,</span><span class="w"> </span><span class="n">user_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">TTL</span><span class="w"> </span><span class="n">event_time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="k">DAY</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">DISK</span><span class="w"> </span><span class="s1">&#39;cold&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">SETTINGS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">storage_policy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hot_to_cold&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ğŸ“Œ <strong>ä¸ºä»€ä¹ˆä¸€å®šè¦ ReplicatedMergeTreeï¼Ÿ</strong></p>
<ul>
<li>æ‰©å®¹åè‡ªåŠ¨è¡¥æ•°æ®</li>
<li>èŠ‚ç‚¹æŒ‚æ‰ä¸ä¸¢æ•°æ®</li>
<li>æ”¯æŒæ»šåŠ¨å‡çº§</li>
</ul>
<hr>
<h2 class="heading-element" id="9-distributed-è¡¨ç»Ÿä¸€è¯»å†™å…¥å£"><span>9. Distributed è¡¨ï¼ˆç»Ÿä¸€è¯»å†™å…¥å£ï¼‰</span>
  <a href="#9-distributed-%e8%a1%a8%e7%bb%9f%e4%b8%80%e8%af%bb%e5%86%99%e5%85%a5%e5%8f%a3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">analytics</span><span class="p">.</span><span class="n">events_all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="k">CLUSTER</span><span class="w"> </span><span class="n">default_cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AS</span><span class="w"> </span><span class="n">analytics</span><span class="p">.</span><span class="n">events</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ENGINE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Distributed</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">default_cluster</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">analytics</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">events</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">cityHash64</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ä½¿ç”¨åŸåˆ™</strong>ï¼š</p>
<ul>
<li>å†™ â†’ <code>events_all</code></li>
<li>æŸ¥ â†’ <code>events_all</code></li>
<li>ä¸ç›´æ¥è®¿é—®æœ¬åœ°è¡¨</li>
</ul>
<hr>
<h2 class="heading-element" id="10-å¤‡ä»½ä¸æ¢å¤"><span>10. å¤‡ä»½ä¸æ¢å¤</span>
  <a href="#10-%e5%a4%87%e4%bb%bd%e4%b8%8e%e6%81%a2%e5%a4%8d" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="101-æ¨èå·¥å…·clickhouse-backup"><span>10.1. æ¨èå·¥å…·ï¼šclickhouse-backup</span>
  <a href="#101-%e6%8e%a8%e8%8d%90%e5%b7%a5%e5%85%b7clickhouse-backup" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><strong>éƒ¨ç½²ä½ç½®</strong>ï¼š
ğŸ‘‰ æ¯ä¸ª <code>ClickHouse</code> èŠ‚ç‚¹ï¼ˆæˆ–è¿ç»´æœºï¼‰</p>
<hr>
<h3 class="heading-element" id="102-åˆ›å»ºå¤‡ä»½"><span>10.2. åˆ›å»ºå¤‡ä»½</span>
  <a href="#102-%e5%88%9b%e5%bb%ba%e5%a4%87%e4%bb%bd" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>åŒ…å«ï¼š</p>
<ul>
<li>è¡¨ç»“æ„</li>
<li>æ•°æ®ï¼ˆæ”¯æŒå¢é‡ï¼‰</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">clickhouse-backup create daily_2025_12_18</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 class="heading-element" id="103-æ¢å¤ç¤ºä¾‹å•è¡¨"><span>10.3. æ¢å¤ç¤ºä¾‹ï¼ˆå•è¡¨ï¼‰</span>
  <a href="#103-%e6%81%a2%e5%a4%8d%e7%a4%ba%e4%be%8b%e5%8d%95%e8%a1%a8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">clickhouse-backup restore --table analytics.events daily_2025_12_18</span></span></code></pre></td></tr></table>
</div>
</div><h3 class="heading-element" id="104-æ¢å¤æ•´ä¸ªæ•°æ®åº“"><span>10.4. æ¢å¤æ•´ä¸ªæ•°æ®åº“</span>
  <a href="#104-%e6%81%a2%e5%a4%8d%e6%95%b4%e4%b8%aa%e6%95%b0%e6%8d%ae%e5%ba%93" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">clickhouse-backup restore daily_2025_12_18</span></span></code></pre></td></tr></table>
</div>
</div><h3 class="heading-element" id="105-å…¶ä»–"><span>10.5. å…¶ä»–</span>
  <a href="#105-%e5%85%b6%e4%bb%96" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>å¤‡ä»½ <code>/var/lib/clickhouse</code> ç›®å½•(æœ€åé˜²çº¿,ä½†å¯èƒ½ä¸é è°±)</li>
</ul>
<hr>
<h2 class="heading-element" id="11-å‡çº§å’Œè¿ç§»"><span>11. å‡çº§å’Œè¿ç§»</span>
  <a href="#11-%e5%8d%87%e7%ba%a7%e5%92%8c%e8%bf%81%e7%a7%bb" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>ğŸ“Œ è¦æ±‚ï¼š</p>
<ul>
<li>å‰¯æœ¬ â‰¥ 2</li>
<li>Keeper å­˜æ´»</li>
</ul>
<h3 class="heading-element" id="111-æ­£ç¡®å§¿åŠ¿æ»šåŠ¨å‡çº§"><span>11.1. æ­£ç¡®å§¿åŠ¿ï¼šæ»šåŠ¨å‡çº§</span>
  <a href="#111-%e6%ad%a3%e7%a1%ae%e5%a7%bf%e5%8a%bf%e6%bb%9a%e5%8a%a8%e5%8d%87%e7%ba%a7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">node1 å‡çº§ â†’ OK
</span></span><span class="line"><span class="cl">node2 å‡çº§ â†’ OK</span></span></code></pre></td></tr></table>
</div>
</div><h3 class="heading-element" id="112-å‡çº§å‰å¿…åš"><span>11.2. å‡çº§å‰å¿…åšï¼š</span>
  <a href="#112-%e5%8d%87%e7%ba%a7%e5%89%8d%e5%bf%85%e5%81%9a" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SYSTEM SYNC REPLICA<span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 class="heading-element" id="113-è¿ç§»æ¢æœºå™¨--æ‰©å®¹"><span>11.3. è¿ç§»ï¼ˆæ¢æœºå™¨ / æ‰©å®¹ï¼‰</span>
  <a href="#113-%e8%bf%81%e7%a7%bb%e6%8d%a2%e6%9c%ba%e5%99%a8--%e6%89%a9%e5%ae%b9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>æ­£ç¡®æ–¹å¼:</p>
<ul>
<li>æ–°èŠ‚ç‚¹ä¸Šçº¿</li>
<li>åŠ å…¥ <code>cluster.xml</code></li>
<li><code>Replicated</code> è¡¨è‡ªåŠ¨åŒæ­¥</li>
<li>ç§»é™¤æ—§èŠ‚ç‚¹</li>
</ul>
<h2 class="heading-element" id="12-é«˜å¯ç”¨"><span>12. é«˜å¯ç”¨</span>
  <a href="#12-%e9%ab%98%e5%8f%af%e7%94%a8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="121-è‡ªåŠ¨é‡è¯•-9000-ç«¯å£"><span>12.1. è‡ªåŠ¨é‡è¯• 9000 ç«¯å£</span>
  <a href="#121-%e8%87%aa%e5%8a%a8%e9%87%8d%e8%af%95-9000-%e7%ab%af%e5%8f%a3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h3 class="heading-element" id="122-haproxy"><span>12.2. HAProxy</span>
  <a href="#122-haproxy" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>æ”¯æŒ <code>TCP</code></li>
<li>å¥åº·æ£€æŸ¥å¥½</li>
<li>æ€§èƒ½ç¨³å®š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">frontend clickhouse
</span></span><span class="line"><span class="cl">    <span class="nb">bind</span> *:9000
</span></span><span class="line"><span class="cl">    default_backend ch_nodes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">backend ch_nodes
</span></span><span class="line"><span class="cl">    balance roundrobin
</span></span><span class="line"><span class="cl">    server n1 172.31.10.11:9000 check
</span></span><span class="line"><span class="cl">    server n2 172.31.10.110:9000 check</span></span></code></pre></td></tr></table>
</div>
</div><h3 class="heading-element" id="123-ä¸æ¨è-nginxé™¤é-http"><span>12.3. ä¸æ¨è Nginxï¼ˆé™¤é HTTPï¼‰</span>
  <a href="#123-%e4%b8%8d%e6%8e%a8%e8%8d%90-nginx%e9%99%a4%e9%9d%9e-http" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p><code>Nginx</code>ï¼š</p>
<ul>
<li>æ›´é€‚åˆ <code>8123</code></li>
<li>ä¸é€‚åˆé«˜å¹¶å‘ <code>TCP</code> æŸ¥è¯¢</li>
</ul>
<h2 class="heading-element" id="13-æ‰©å®¹ä¸è‡ªåŠ¨å¤åˆ¶æ˜¯å¦‚ä½•å‘ç”Ÿçš„"><span>13. æ‰©å®¹ä¸è‡ªåŠ¨å¤åˆ¶æ˜¯å¦‚ä½•å‘ç”Ÿçš„ï¼Ÿ</span>
  <a href="#13-%e6%89%a9%e5%ae%b9%e4%b8%8e%e8%87%aa%e5%8a%a8%e5%a4%8d%e5%88%b6%e6%98%af%e5%a6%82%e4%bd%95%e5%8f%91%e7%94%9f%e7%9a%84" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ol>
<li>æ–°èŠ‚ç‚¹ä¸Šçº¿</li>
<li>åŠ å…¥ <code>cluster.xml</code></li>
<li>æ–°èŠ‚ç‚¹é…ç½® Keeper</li>
<li>Replicated è¡¨è‡ªåŠ¨ï¼š
<ul>
<li>æ³¨å†Œå‰¯æœ¬</li>
<li>æ‹‰å–å†å²æ•°æ®</li>
</ul>
</li>
</ol>
<p>å¯æ‰‹åŠ¨è§¦å‘ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SYSTEM</span><span class="w"> </span><span class="n">SYNC</span><span class="w"> </span><span class="n">REPLICA</span><span class="w"> </span><span class="n">analytics</span><span class="p">.</span><span class="n">events</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 class="heading-element" id="14-æ€»ç»“ä¸€å¥—ä¸ä¼šåæ‚”çš„-clickhouse-æ¨¡æ¿"><span>14. æ€»ç»“ï¼šä¸€å¥—â€œä¸ä¼šåæ‚”â€çš„ ClickHouse æ¨¡æ¿</span>
  <a href="#14-%e6%80%bb%e7%bb%93%e4%b8%80%e5%a5%97%e4%b8%8d%e4%bc%9a%e5%90%8e%e6%82%94%e7%9a%84-clickhouse-%e6%a8%a1%e6%9d%bf" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>é›†ç¾¤æ¨¡å¼ <strong>ä»ç¬¬ä¸€å¤©å¼€å§‹</strong></li>
<li>Keeper æ˜¯åœ°åŸºï¼Œä¸æ˜¯é™„åŠ å“</li>
<li>å†·çƒ­åˆ†å±‚æ˜¯æŠ½è±¡ï¼Œä¸æ˜¯ç¡¬ä»¶</li>
<li>è¡¨æ˜¯å¦å¯å¤åˆ¶ï¼Œå–å†³äºç¬¬ä¸€æ¬¡å»ºè¡¨</li>
</ul>
<h2 class="heading-element" id="15-å…¶ä»–"><span>15. å…¶ä»–</span>
  <a href="#15-%e5%85%b6%e4%bb%96" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- æŸ¥çœ‹é›†ç¾¤çŠ¶æ€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">clusters</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹ Keeper ä¸­çš„ ZK è·¯å¾„æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">zookeeper</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹å‰¯æœ¬çŠ¶æ€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">replicas</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- éªŒè¯é›†ç¾¤æ˜¯å¦ç”Ÿæ•ˆ(åœ¨ä»»æ„ä¸€å°æ‰§è¡Œ)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">clusters</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">cluster</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;default_cluster&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- åˆ›å»ºæ•°æ®åº“(é›†ç¾¤)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">test_cluster</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">CLUSTER</span><span class="w"> </span><span class="n">default_cluster</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- éªŒè¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SHOW</span><span class="w"> </span><span class="n">DATABASES</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- é›†ç¾¤æ‹“æ‰‘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">cluster</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">shard_num</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">replica_num</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">host_name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">host_address</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">port</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">clusters</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">shard_num</span><span class="p">,</span><span class="w"> </span><span class="n">replica_num</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--å½“å‰èŠ‚ç‚¹èº«ä»½ï¼ˆå®æ˜¯å¦ç”Ÿæ•ˆï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">getMacro</span><span class="p">(</span><span class="s1">&#39;shard&#39;</span><span class="p">)</span><span class="w">   </span><span class="k">AS</span><span class="w"> </span><span class="n">shard</span><span class="p">,</span><span class="w"> </span><span class="n">getMacro</span><span class="p">(</span><span class="s1">&#39;replica&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">replica</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--å‰¯æœ¬æ•´ä½“çŠ¶æ€
</span></span></span><span class="line"><span class="cl"><span class="c1">--å¥åº·å‚è€ƒ: 
</span></span></span><span class="line"><span class="cl"><span class="c1">--is_readonly = 0
</span></span></span><span class="line"><span class="cl"><span class="c1">--queue_size â‰ˆ 0
</span></span></span><span class="line"><span class="cl"><span class="c1">--inserts_in_queue â‰ˆ 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">database</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">table</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">is_leader</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">is_readonly</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">future_parts</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">parts_to_check</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">queue_size</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">inserts_in_queue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">replicas</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--å¤åˆ¶å»¶è¿Ÿ / å †ç§¯è¯¦æƒ…
</span></span></span><span class="line"><span class="cl"><span class="c1">--åˆ¤æ–­æ˜¯å¦å­˜åœ¨å‰¯æœ¬ lag
</span></span></span><span class="line"><span class="cl"><span class="c1">--å‡çº§ / æ‰©å®¹å‰å¿…é¡»æ£€æŸ¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">database</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">table</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">absolute_delay</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">log_max_index</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">log_pointer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">replicas</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- -- å¼ºåˆ¶ä¿®å¤å¸¸ç”¨å‘½ä»¤
</span></span></span><span class="line"><span class="cl"><span class="c1">--ä½¿ç”¨å»ºè®®: 
</span></span></span><span class="line"><span class="cl"><span class="c1">--1. å…ˆ SYNC
</span></span></span><span class="line"><span class="cl"><span class="c1">--2. å† RESTART
</span></span></span><span class="line"><span class="cl"><span class="c1">--3. ä¸è¦éšä¾¿ DROP REPLICA
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- SYSTEM SYNC REPLICA db.table;
</span></span></span><span class="line"><span class="cl"><span class="c1">-- SYSTEM RESTART REPLICA db.table;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--ç£ç›˜çŠ¶æ€
</span></span></span><span class="line"><span class="cl"><span class="c1">--ç”¨é€”: 
</span></span></span><span class="line"><span class="cl"><span class="c1">-- - éªŒè¯ hot / cold æ˜¯å¦åŠ è½½
</span></span></span><span class="line"><span class="cl"><span class="c1">-- - æ’æŸ¥ç£ç›˜ç©ºé—´é—®é¢˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">path</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">free_space</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">total_space</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">disks</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å­˜å‚¨ç­–ç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">storage_policies</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- è¡¨å®é™…ä½¿ç”¨çš„ç£ç›˜
</span></span></span><span class="line"><span class="cl"><span class="c1">-- - ç”¨é€”: 
</span></span></span><span class="line"><span class="cl"><span class="c1">-- - éªŒè¯ TTL æ˜¯å¦çœŸçš„ move åˆ° cold
</span></span></span><span class="line"><span class="cl"><span class="c1">-- - å†·çƒ­åˆ†å±‚æ˜¯å¦ç”Ÿæ•ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">database</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">table</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">disk_name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">sum</span><span class="p">(</span><span class="n">bytes_on_disk</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">bytes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">parts</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">database</span><span class="p">,</span><span class="w"> </span><span class="k">table</span><span class="p">,</span><span class="w"> </span><span class="n">disk_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--åˆ†åŒº / part çŠ¶æ€ 
</span></span></span><span class="line"><span class="cl"><span class="c1">-- - ç”¨é€”: 
</span></span></span><span class="line"><span class="cl"><span class="c1">-- - parts æ•°è¿‡å¤š = merge å‹åŠ›
</span></span></span><span class="line"><span class="cl"><span class="c1">-- - è¿ç»´è°ƒä¼˜çš„åŸºç¡€æŒ‡æ ‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">database</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">table</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">count</span><span class="p">()</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">parts</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">sum</span><span class="p">(</span><span class="n">bytes_on_disk</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">size</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">parts</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">active</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">database</span><span class="p">,</span><span class="w"> </span><span class="k">table</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--å½“å‰æ­£åœ¨æ‰§è¡Œçš„æŸ¥è¯¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">query_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">user</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">elapsed</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">memory_usage</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">query</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">processes</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æœ€è¿‘æ…¢æŸ¥è¯¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">query_duration_ms</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">read_rows</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">result_rows</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">query</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">query_log</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">query_duration_ms</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">--æ•°æ®åº“çº§å®¹é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">database</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">sum</span><span class="p">(</span><span class="n">bytes_on_disk</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">size</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">parts</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">active</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">database</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="æ›´æ–°äº 2025-12-17 00:00:00">æ›´æ–°äº 2025-12-17&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/posts/linux/clickhouse%E9%9B%86%E7%BE%A4%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97/index.md" title="é˜…è¯»åŸå§‹æ–‡æ¡£" class="link-to-markdown">é˜…è¯»åŸå§‹æ–‡æ¡£</a></span></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/linux/" class="post-tag" title="æ ‡ç­¾ - Linux">Linux</a><a href="/tags/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" class="post-tag" title="æ ‡ç­¾ - è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="/">ä¸»é¡µ</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/hugo/ai%E5%88%9B%E4%BD%9C%E5%86%85%E5%AE%B9%E5%A3%B0%E6%98%8E%E7%BB%84%E4%BB%B6/" class="post-nav-item" rel="prev" title="AIåˆ›ä½œå†…å®¹å£°æ˜ç»„ä»¶"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>AIåˆ›ä½œå†…å®¹å£°æ˜ç»„ä»¶</a><a href="/posts/linux/%E9%82%A3%E4%BA%9B%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB%E7%9A%84%E8%AE%B0%E5%BD%95.3/" class="post-nav-item" rel="next" title="é‚£äº›æ‚ä¸ƒæ‚å…«çš„è®°å½•(ä¸‰)">é‚£äº›æ‚ä¸ƒæ‚å…«çš„è®°å½•(ä¸‰)<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="gitalk" class="comment"></div><noscript>
        Please enable JavaScript to view the comments powered by <a href="https://github.com/gitalk/gitalk" rel="external nofollow noopener noreferrer">Gitalk</a>.
      </noscript></div></article>

  <aside class="toc" id="toc-auto" aria-label="ç›®å½•"><h2 class="toc-title">ç›®å½•&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line"><script type="text/javascript">(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y)})(window,document,"clarity","script","jtpwi0tdz1");</script></div><div class="footer-line">
        æ‰˜ç®¡åœ¨&nbsp;<a title="Vercel" href="https://vercel.com" target="_blank" rel="noopener noreffer">Vercel</a> & <a title="Aliyun" href="https://www.aliyun.com" target="_blank" rel="noopener noreffer">Aliyun</a></div><div class="footer-line powered">ç”± <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.152.1"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.4.0-alpha.1"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2022 - 2025</span><span class="author" itemprop="copyrightHolder">
              <a href="https://blog.0x5c0f.cc"target="_blank" rel="external nofollow noopener noreferrer">0x5c0f</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">CC BY-NC-SA 4.0</a></span></div><div class="footer-line beian"><span class="gov"><img src="/images/gov.png" style="height: 16px;width: 16px; display: inline-block;vertical-align: middle;margin-right: 3px;"/><a href="https://beian.mps.gov.cn/#/query/webSearch?code=50010602503871" rel="noreferrer" target="_blank">æ¸å…¬ç½‘å®‰å¤‡50010602503871</a></span><span class="icp footer-divider"><a href="https://beian.miit.gov.cn" target="_blank">æ¸ICPå¤‡2020011834å·-2</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="å›åˆ°é¡¶éƒ¨"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div><div class="fixed-button view-comments d-none" role="button" aria-label="æŸ¥çœ‹è¯„è®º"><i class="fa-solid fa-comment fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">è¯¥ç½‘ç«™åœ¨å¯ç”¨ JavaScript çš„æƒ…å†µä¸‹æ•ˆæœæœ€ä½³ã€‚</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/gitalk/gitalk.min.e525ab86258d1091611cdf6bbc548866f3bf97020fe6aadf3ce8e0ccd9aaec45f31b1cd3dd48d61e1eaf504f02e5666c4d41bd9e580964607a208acefd9cea54.css" integrity="sha512-5SWrhiWNEJFhHN9rvFSIZvO/lwIP5qrfPOjgzNmq7EXzGxzT3UjWHh6vUE8C5WZsTUG9nlgJZGB6IIrO/ZzqVA=="><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.4da240a43b27e4766b66680f1a246cc89ccd7354d9209947fd4484ead2c58f04ef5728b29d9efd50b0fd0c8ec4e2a267a0326f798c41a70fbe21ae975213ef27.css" integrity="sha512-TaJApDsn5HZrZmgPGiRsyJzNc1TZIJlH/USE6tLFjwTvVyiynZ79ULD9DI7E4qJnoDJveYxBpw++Ia6XUhPvJw=="><script src="/lib/gitalk/gitalk.min.dde1928759bb3865d3935d3953043fac0b92996eb1d731702d7bc33a6a0c4cd97217fc783230889b91b0c1bc55b4a6f5b00fcc2109cec2e63b25b8b80de25ca7.js" integrity="sha512-3eGSh1m7OGXTk105UwQ/rAuSmW6x1zFwLXvDOmoMTNlyF/x4MjCIm5GwwbxVtKb1sA/MIQnOwuY7Jbi4DeJcpw=="></script><script src="/lib/autocomplete/autocomplete.min.7e654c67e741180b83f7b4d829967003fea37a5d5014f549f0a3d7f945d2b73e73e22a1dd04a7b68712c846f004232f3030d07305784fab026100af12af8f0ac.js" integrity="sha512-fmVMZ+dBGAuD97TYKZZwA/6jel1QFPVJ8KPX+UXStz5z4iod0Ep7aHEshG8AQjLzAw0HMFeE+rAmEArxKvjwrA==" defer></script><script src="/lib/fuse/fuse.min.36ac35b47de6a5abe46bd71009ce7359611935f20f74e6324058e557536f7e512d434fd723a650f87fc3dd880976a49426530b00f463fe85e56870856c50a3a1.js" integrity="sha512-Nqw1tH3mpavka9cQCc5zWWEZNfIPdOYyQFjlV1NvflEtQ0/XI6ZQ+H/D3YgJdqSUJlMLAPRj/oXlaHCFbFCjoQ==" defer></script><script src="/lib/instant-page/instantpage.min.b9c40b72cc23e52964ed3f0c38f689e0f35253b7838505f1414726a8c52ea7480d4673ad1da26b15355a2da835147485cf65fd45b24a885a1cd8ca97cd6ffec7.js" integrity="sha512-ucQLcswj5Slk7T8MOPaJ4PNSU7eDhQXxQUcmqMUup0gNRnOtHaJrFTVaLag1FHSFz2X9RbJKiFoc2MqXzW/+xw==" async defer type="module"></script><script src="/lib/typeit/index.umd.1b3200cb448f5cd1f548f2781452643d3511a43584b377b82c03a58055da4fdb7bc8f6c6c2ce846480c7677ff25bfd0d75f15823c09443ab18e0fd2cad792587.js" integrity="sha512-GzIAy0SPXNH1SPJ4FFJkPTURpDWEs3e4LAOlgFXaT9t7yPbGws6EZIDHZ3/yW/0NdfFYI8CUQ6sY4P0srXklhw==" defer></script><script src="/js/lib/mermaid.min.2b530dd7128681b1f5554da619f078f62350cb0f6a296a79f1b21eee6f8bc3bfd4e776d51f7bd63b156146dc194d764f71bdf1af83d685aa26410c70dd367dad.js" integrity="sha512-K1MN1xKGgbH1VU2mGfB49iNQyw9qKWp58bIe7m+Lw7/U53bVH3vWOxVhRtwZTXZPcb3xr4PWhaomQQxw3TZ9rQ==" type="module"></script><script src="/lib/pace/pace.min.d9c6ec406768c0d0cf70aba805dd9b09cb09932f3b32fd0b12d0ff9ee9c952093a30e6138153068a14bfc4212084d7f4e033e13622780d9c390710ddd6ec8e77.js" integrity="sha512-2cbsQGdowNDPcKuoBd2bCcsJky87Mv0LEtD/nunJUgk6MOYTgVMGihS/xCEghNf04DPhNiJ4DZw5BxDd1uyOdw==" async defer></script><script src="/js/particle.min.19d0e7020a0b241b6aa18b222d41c1d4a0f3fe48feb4bbe5dc127019e86952a3f0bd6fd7cdc87b98da4bb919e3e7ca68ab8b6f96389e2efacb47b36f92e2892c.js" integrity="sha512-GdDnAgoLJBtqoYsiLUHB1KDz/kj+tLvl3BJwGehpUqPwvW/Xzch7mNpLuRnj58poq4tvljieLvrLR7NvkuKJLA==" defer></script><script src="/js/watermark.seal.min.3cead0eb6c9989d4fc6d00173ec8836d3919dd8ce75df57a75e113624633c9bce14f893cde7d2ef23642b62a53da22021371732f8e4156128df74ce049262f58.js" integrity="sha512-POrQ62yZidT8bQAXPsiDbTkZ3YznXfV6deETYkYzybzhT4k83n0u8jZCtipT2iICE3FzL45BVhKN90zgSSYvWA==" defer></script><script src="/js/ext-utils.00b3ce7d82b0ec4b5808452e6fdc89937cea0772879e35da39ac4aab50bfdafddf3f2863e7677be1732d17ac21d3563a43c2a0ae96491a02ba776df4f74a9ce1.js" integrity="sha512-ALPOfYKw7EtYCEUub9yJk3zqB3KHnjXaOaxKq1C/2v3fPyhj52d74XMtF6wh01Y6Q8KgrpZJGgK6d23090qc4Q==" defer></script><script>window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","editLockTitle":"é”å®šå¯ç¼–è¾‘ä»£ç å—","editUnLockTitle":"è§£é”å¯ç¼–è¾‘ä»£ç å—","editable":true,"maxShownLines":100},"comment":{"enable":true,"expired":false,"gitalk":{"admin":["0x5c0f"],"clientID":"3248954ea2af12f77f46","clientSecret":"a463972c37d7b438e2635d4fc0a8f06174565c67","id":"2025-12-17T00:00:00Z","owner":"0x5c0f","repo":"blog","title":"clickhouseé›†ç¾¤å®è·µæŒ‡å—"}},"search":{"distance":100,"findAllMatches":true,"fuseIndexURL":"/search.json","highlightTag":"mark","ignoreFieldNorm":true,"ignoreLocation":true,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":30,"threshold":0.2,"type":"fuse","useExtendedSearch":true},"typeit":{"cursorChar":"_","cursorSpeed":1000,"duration":9000,"loop":false,"speed":100},"version":"v0.4.0-alpha.1"};</script><script src="/js/theme.min.495a7d0a4c4576e70f3b84b0c735e82d682e5c67c25d73573062e611b4ee729430367036f5cf66a379e1bae8b5e96327e47e4c17822a5203523dbe962956a3a5.js" integrity="sha512-SVp9CkxFducPO4SwxzXoLWguXGfCXXNXMGLmEbTucpQwNnA29c9mo3nhuui16WMn5H5MF4IqUgNSPb6WKVajpQ==" defer></script><script src="/lib/translate.min.88eab6458572fed1ef29f13c8cad30a51e0b1b403bcd162eb1a9e2fea0c98c59618a90b1871487d72d34f03fc152edcfc781651a2632ed5dfe68a3291ea11d65.js" integrity="sha512-iOq2RYVy/tHvKfE8jK0wpR4LG0A7zRYusani/qDJjFlhipCxhxSH1y008D/BUu3Px4FlGiYy7V3+aKMpHqEdZQ==" defer></script><script>window.ATConfig={"hugoLangCodes":["zh-CN"],"hugoLangMap":{"zh-CN":"/posts/linux/clickhouse%E9%9B%86%E7%BE%A4%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97/"}};</script><script src="/js/translate.fixit.min.e3f2ad8113afe03308df2f750857a560d39019deeabe7a3c50ad0f54397a0e407ea765f93dec9499a8eaea2bad096eff7202811a2bff25fdaef834ee19a6a8b9.js" integrity="sha512-4/KtgROv4DMI3y91CFelYNOQGd7qvno8UK0PVDl6DkB+p2X5PeyUmajq6iutCW7/cgKBGiv/Jf2u+DTuGaaouQ==" defer></script></body>
</html>
