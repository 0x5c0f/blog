<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>Iptables - 标签 - 一个曾经的小码农...</title>
        <link>https://blog.0x5c0f.cc/tags/iptables/</link>
        <description>Iptables - 标签 - 一个曾经的小码农...</description>
        <generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>mail@0x5c0f.cc (0x5c0f)</managingEditor>
            <webMaster>mail@0x5c0f.cc (0x5c0f)</webMaster><lastBuildDate>Fri, 08 Mar 2019 00:00:00 &#43;0000</lastBuildDate><atom:link href="https://blog.0x5c0f.cc/tags/iptables/" rel="self" type="application/rss+xml" /><item>
    <title>Iptables常用</title>
    <link>https://blog.0x5c0f.cc/2019/iptables%E5%B8%B8%E7%94%A8/</link>
    <pubDate>Fri, 08 Mar 2019 00:00:00 &#43;0000</pubDate><author>
                        <name>0x5c0f</name><uri>https://tools.0x5c0f.cc</uri><email>mail@0x5c0f.cc</email></author><guid>https://blog.0x5c0f.cc/2019/iptables%E5%B8%B8%E7%94%A8/</guid>
    <description><![CDATA[<h1 id="1-iptables--工作流程" class="headerLink">
    <a href="#1-iptables--%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b" class="header-mark"></a>1. iptables  工作流程</h1><ol>
<li>防火墙是一层一层过滤的，实际是按照配置规则的顺序从上到下，从前到后进行过滤的。</li>
<li>如果匹配上规则，即明确表明是阻止还是通过，此时数据包就不在向下进行新的匹配规则了。</li>
<li>如果所有规则中没有明确表明是阻止还是通过这个数据包，也就是没有匹配上的规则，向下进行匹配，直到匹配默认规则得到明确的阻止还是通过.</li>
<li>防火墙的默认规则是对应链的所有的规则执行完成后才会执行。</li>
</ol>
<h1 id="2-iptables-表和链" class="headerLink">
    <a href="#2-iptables-%e8%a1%a8%e5%92%8c%e9%93%be" class="header-mark"></a>2. iptables 表和链</h1><ul>
<li>4 表:</li>
</ul>
<table>
  <thead>
      <tr>
          <th style="text-align: left"></th>
          <th style="text-align: left"></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">filter</td>
          <td style="text-align: left">包过滤，用于防火墙规则。</td>
      </tr>
      <tr>
          <td style="text-align: left">net</td>
          <td style="text-align: left">地址转换，用于网关路由器。</td>
      </tr>
      <tr>
          <td style="text-align: left">mangle</td>
          <td style="text-align: left">数据包修改（QOS），用于实现服务质量。</td>
      </tr>
      <tr>
          <td style="text-align: left">raw</td>
          <td style="text-align: left">高级功能，如：网址过滤。</td>
      </tr>
  </tbody>
</table>
<ul>
<li>5链:</li>
</ul>
<table>
  <thead>
      <tr>
          <th style="text-align: left"></th>
          <th style="text-align: left"></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">INPUT链</td>
          <td style="text-align: left">处理输入数据包。</td>
      </tr>
      <tr>
          <td style="text-align: left">OUTPUT链</td>
          <td style="text-align: left">处理输出数据包。</td>
      </tr>
      <tr>
          <td style="text-align: left">PORWARD链</td>
          <td style="text-align: left">处理转发数据包。</td>
      </tr>
      <tr>
          <td style="text-align: left">PREROUTING链</td>
          <td style="text-align: left">用于目标地址转换（DNAT）。</td>
      </tr>
      <tr>
          <td style="text-align: left">POSTOUTING链</td>
          <td style="text-align: left">用于源地址转换（SNAT）。</td>
      </tr>
  </tbody>
</table>
<h1 id="3-iptables-命令" class="headerLink">
    <a href="#3-iptables-%e5%91%bd%e4%bb%a4" class="header-mark"></a>3. iptables 命令</h1><table>
  <thead>
      <tr>
          <th style="text-align: left">参数</th>
          <th style="text-align: left">作用</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>-F</code></td>
          <td style="text-align: left">清空所有规则，不会处理默认规则</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-X</code></td>
          <td style="text-align: left">删除用户自定义的链</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-Z</code></td>
          <td style="text-align: left">清空链的计数器</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-t</code></td>
          <td style="text-align: left">指定表(默认filter)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-A</code></td>
          <td style="text-align: left">添加规则到指定链的结尾(查找对应链，做什么处理)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-I</code></td>
          <td style="text-align: left">添加规则到指定链的开头(查找对应链，做什么处理)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-P</code></td>
          <td style="text-align: left">指定协议: all(默认)、tcp、udp、icmp</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>--dport</code></td>
          <td style="text-align: left">指定目的端口(端口范围冒号分割,如:80:89)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>--sport</code></td>
          <td style="text-align: left">指定源端口(端口范围冒号分割,如:80:89)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-m multiport  --dport/--sport</code></td>
          <td style="text-align: left">指定匹配多个端口,需配合(<code>--dport</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-j</code></td>
          <td style="text-align: left">行为 ACCEPT(接受)、DROP(丢弃)、REJECT(拒绝:REJECT会反馈给拒绝对象信息)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-s</code></td>
          <td style="text-align: left">指定源ip地址</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-i</code></td>
          <td style="text-align: left">指定进入的网卡</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-o</code></td>
          <td style="text-align: left">指定出去的网卡</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-n</code></td>
          <td style="text-align: left">以数字形式显示ip和端口(默认主机名、网络名),需配合<code>-L</code>使用</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-L</code></td>
          <td style="text-align: left">列出所有规则</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-D</code></td>
          <td style="text-align: left">删除单条规则</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>--line-number</code></td>
          <td style="text-align: left">显示序号</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-m state --state </code></td>
          <td style="text-align: left">new: 已经或将启动新的连接、ESTABLISHED:已建立的连接、 RELATED: 正在启动的新连接、INVALID: 非法或无法识别的</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>-m limit --limit n/{second/minute/hour}</code></td>
          <td style="text-align: left">限制指定时间包的允许通过数量及并发数</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>--limit-burst [n]</code></td>
          <td style="text-align: left">在同一时间内允许通过的请求<code>n</code>个</td>
      </tr>
  </tbody>
</table>
<h1 id="4-示例" class="headerLink">
    <a href="#4-%e7%a4%ba%e4%be%8b" class="header-mark"></a>4. 示例</h1><ol>
<li>清空规则、用户自定义链、链的计数器</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pr]]></description>
</item></channel>
</rss>
